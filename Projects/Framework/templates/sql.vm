## add current file content first (regenerated table are removed from this content)
${WSM.sqlFileContent}#foreach($dataObject in ${WSM.selectedDataObjects})
 #if (${dataObject.persisted})
CREATE TABLE ${dataObject.tableName} 
(
  #foreach($attr in ${dataObject.attributeDefs})
    ${attr.columnName} ${attr.columnType} #if (${attr.required}) NOT NULL#end,
  #end
  CONSTRAINT ${dataObject.tableName}_PK PRIMARY KEY(${dataObject.keyColumnNamesAsString})
);
 #end
#end

#if (${WSM.useMCS})
CREATE TABLE STORAGE_OBJECT 
(
      CREATED_ON VARCHAR ,
      E_TAG VARCHAR ,
      ID VARCHAR  NOT NULL,
      MODIFIED_ON VARCHAR ,
      CREATED_BY VARCHAR ,
      MODIFIED_BY VARCHAR ,
      NAME VARCHAR ,
      CONTENT_TYPE VARCHAR ,
      CONTENT_LENGTH NUMERIC ,
      COLLECTION_NAME VARCHAR NOT NULL,
      FILE_PATH VARCHAR ,
      STORE_ON_DEVICE VARCHAR ,
    CONSTRAINT STORAGE_OBJECT_PK PRIMARY KEY(ID, COLLECTION_NAME)
);
#end

CREATE TABLE DATA_SYNCH_ACTIONS 
(
      ID NUMERIC NOT NULL,
      SERVICE_CLASS_NAME VARCHAR NOT NULL,
      ENTITY_CLASS_NAME VARCHAR NOT NULL,
      JSON_PAYLOAD VARCHAR ,
      ACTION VARCHAR NOT NULL,
      DATE_CREATED DATE NOT NULL,
      DATE_LAST_SYNCH DATE NOT NULL,
      LAST_SYNCH_ERROR VARCHAR,
      CUSTOM_METHOD_NAME VARCHAR,
    CONSTRAINT DSA_PK PRIMARY KEY(SERVICE_CLASS_NAME ,ID)
);

CREATE TABLE WEB_SERVICE_CALL 
(
      ID NUMERIC  NOT NULL,
      CONNECTION VARCHAR ,
      REQUEST VARCHAR ,
      METHOD VARCHAR ,
      REQUEST_HEADERS VARCHAR ,
      DURATION NUMERIC ,
      REQUEST_PAYLOAD VARCHAR ,
      RESPONSE_PAYLOAD VARCHAR ,
      ERROR_MESSAGE VARCHAR ,
      TIMESTAMP DATE ,
    CONSTRAINT WEB_SERVICE_CALL_PK PRIMARY KEY(ID)
);
